# DES-MITM

Meet in the middle DES based hash brute force attacker for "weakhash" from Northsec 2020. The vulnerable code is in the ChallengeCode folder, this go program finds keys which will pass validation and allow for running the "change_marks" program on the server.

has a hard coded plaintext as a base for the hash function, and a known ciphertext in the "decrypt with all keys" function

TODO: change this to accept a plaintext/ciphertext pair as commandline inputs for future use

Runs an MITM attack - first encrypts the plaintext by 2^30 possible keys and stores all hash:key pairs in a map
next decrypts the known ciphertext by all possible keys until it finds a match

keys are generated by using counter = counter | 0x0101010101010101 +1
DES drops the LSB of each byte, so this loops through all possible DES keys without duplication. Basically every odd bite is converted to 
an even byte, and then 1 is added. There will be a single duplication every time a middle byte is even, and then it will correct in the
next step. keygentest.py gives a visual demonstration of how it works.

NOTE - DO NOT RUN THIS IF YOU DON'T KNOW WHAT IT DOES! There are no checks on available processors or memory.
It will eat 32 gb of ram and 100% of 8 cores for 6ish hours. Be aware of this as you plan your day.

